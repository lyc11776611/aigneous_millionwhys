# Development Mode
# Usage: ./docker-start.sh dev (or just ./docker-start.sh)
# Access: http://localhost:8004
# Features: Hot reload, volume-mounted source code

services:
  millionwhys-frontend:
    image: node:20-alpine
    container_name: millionwhys-frontend
    working_dir: /app
    volumes:
      - .:/app
      - /app/node_modules
    ports:
      - "${PORT:-8004}:${PORT:-8004}"
    environment:
      - NODE_ENV=development
      - NEXT_TELEMETRY_DISABLED=1
      - PORT=${PORT:-8004}
    env_file:
      - .env
    command: sh -c "npm install && npx next dev -H 0.0.0.0 -p ${PORT:-8004}"
    stdin_open: true
    tty: true
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:${PORT:-8004}"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
